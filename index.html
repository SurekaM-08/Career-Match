<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Resume OCR Extractor</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 500px; margin: auto; }
        .preview { background: #f8f8f8; padding: 16px; border-radius: 6px; min-height: 80px; margin-top: 16px; }
        #imgPreview { display: none; max-width: 100%; margin-top: 16px; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);}
        button { margin-top: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Upload Resume (Image, PDF, DOCX, or TXT)</h2>
        <input type="file" id="fileInput" accept=".pdf,.docx,.txt,.jpg,.jpeg,.png" />
        <img id="imgPreview" alt="Image preview" />
        <button id="extractBtn">Extract Text</button>
        <div class="preview" id="previewBox">Extracted text will appear here...</div>
    </div>
    <script>
        const fileInput = document.getElementById('fileInput');
        const imgPreview = document.getElementById('imgPreview');
        fileInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imgPreview.src = e.target.result;
                    imgPreview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                imgPreview.src = '';
                imgPreview.style.display = 'none';
            }
        });

        document.getElementById('extractBtn').onclick = function() {
            const file = fileInput.files[0];
            if (!file) {
                alert('Please select a file.');
                return;
            }
            const fd = new FormData();
            fd.append('file', file);
            document.getElementById('extractBtn').disabled = true;
            document.getElementById('previewBox').textContent = 'Extracting...';
            fetch('/upload', { method: 'POST', body: fd })
                .then(r => r.json())
                .then(data => {
                    document.getElementById('extractBtn').disabled = false;
                    document.getElementById('previewBox').textContent = data.extracted_text || 'No text found.';
                })
                .catch(err => {
                    document.getElementById('extractBtn').disabled = false;
                    document.getElementById('previewBox').textContent = 'Error extracting text.';
                });
        };
    </script>
</body>
</html>